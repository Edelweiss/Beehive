{% extends '::base.html.twig' %}

{% block body %}
<h3>{{ correction.title }}, <span id="position" class="edit">{{ correction.position }}</span></h3>
<div id="correction">
  <h4><a href="#">Korrektur</a></h4>
  <div><p id="description" class="editArea">{{ correction.description }}</p></div>
  <h4><a href="#">Definierte Aufgaben</a></h4>
  <div>
    <ul class="task">
      {% for task in correction.tasks %}
        <li>{{ task.category }}, <span id="task{{ task.category }}" class="edit">{{ task.description }}, {{ task.isCleared ? 'yes' : 'no' }}</li>
      {% endfor %}
    </ul>
  </div>
  <h4><a href="#">Weitere Quellen</a></h4>
  <div>
    <ul class="links">
      {% for name,link in correction.links %}
        <li><a href="{{ link }}" target="_blank">{{ name }}</a></li>
      {% endfor %}
    </ul>
  </div>
  <h4><a href="#">Versionslogbuch</a></h4>
  <div>
    <ul class="logs">
      {% for log in logs %}
        <li>Version {{ log.version }} / {{ log.loggedAt.format('Y-m-d H:i:s') }}: {{ log.action }} ({{ log.username }})
          <ul>
            {% for key,value in log.data %}
              <li>{{ key }} = {{ value }}</li>
            {% endfor %}
          </ul>
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

{% block javascripts %}
  {{ parent() }}
  
  <script src="{{ asset('js/jquery/jquery-jeditable.min.js') }}" type="text/javascript"></script>

  <script type="text/javascript">
  
  jQuery(document).ready(function(){
    $('#correction').accordion();
    $('.edit').editable('{{ path('PapyrillioBeehiveBundle_correctionupdate', {'id': correction.id}) }}', {
      id   : 'elementid',
      name : 'newvalue',
      indicator : 'Speichert...',
      tooltip   : 'Klicken zum Editieren...',
      style: 'inherit'
    });
    $('.editArea').editable('{{ path('PapyrillioBeehiveBundle_correctionupdate', {'id': correction.id}) }}', {
      id   : 'elementid',
      name : 'newvalue',
      type: 'textarea',
      cancel: 'Abbrechen',
      submit: 'OK',
      //indicator: '<img src="{{ asset('images/spinner.gif') }}" />',
      indicator : 'Speichert...',
      tooltip   : 'Klicken zum Editieren...'
    });
  });
  
  </script>
{% endblock %}


{% endblock %}
